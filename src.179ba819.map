{"version":3,"sources":["src/index.js"],"names":["msieversion","window","navigator","userAgent","indexOf","match","alert","document","prefix","_addEventListener","support","_addWheelListener","elem","eventName","callback","useCapture","originalEvent","event","target","srcElement","type","deltaMode","deltaX","deltaZ","preventDefault","returnValue","deltaY","wheelDelta","wheelDeltaX","detail","addEventListener","createElement","undefined","onmousewheel","addWheelListener","root","getElementById","c","ctx","getContext","magnifier","magCtx","preContent","functionContent","imageUploader","dragBox","letterUploadBtn","closeBtn","sideUploadBtn","sideResetBtn","colorPicker","rgbInput","rgbaInput","hexInput","copyRbgBtn","copyRbgaBtn","copyHexBtn","hitPoint","x","y","moveStartOffset","image","Image","elargeScale","canvasHeight","height","canvasWidth","width","desX","desY","imageHeight","imageWidth","desH","desW","aspectRatio","initialParam","moveMode","main","initEvent","e","oncontextmenu","value","show","hide","click","reset","imgW","imgH","dx","dy","dw","dh","draw","fileList","files","length","loadImage","dataTransfer","onload","onmousemove","mousemove","onmouseout","mouseout","onmousedown","button","getRelativePosition","clientX","clientY","color","getPixelColor","rgb","rgba","hex","onmouseup","style","display","cursor","select","execCommand","elargeImage","shrinkImage","relativePos","left","top","magnify","dragImage","clearRect","rect","ix","i","iy","j","fillStyle","fillRect","beginPath","strokeStyle","moveTo","lineTo","stroke","closePath","file","fileurl","URL","createObjectURL","src","oL","oT","ideW","idwH","drawImage","targetCtx","imageData","pixel","getImageData","data","r","g","b","a","Math","round","rHex","toString","gHex","bHex","mouseX","mouseY","ele","pos","getBoundingClientRect"],"mappings":"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","file":"src.179ba819.map","sourceRoot":"..","sourcesContent":["    // warning! codes below are horrible\r\n\r\nfunction msieversion() {\r\n    var ua = window.navigator.userAgent;\r\n    var msie = ua.indexOf(\"MSIE \");\r\n\r\n    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\\:11\\./))  // If Internet Explorer, return version number\r\n    {\r\n        //alert(parseInt(ua.substring(msie + 5, ua.indexOf(\".\", msie))));\r\n        alert(\"Sorry, this feature is temporarily not compatible with your browser.\");\r\n    }\r\n}\r\n\r\n(function(window,document) {\r\n\r\n    var prefix = \"\", _addEventListener, support;//, onwheel\r\n\r\n    // detect event model\r\n    if ( window.addEventListener ) {\r\n        _addEventListener = \"addEventListener\";\r\n    } else {\r\n        _addEventListener = \"attachEvent\";\r\n        prefix = \"on\";\r\n    }\r\n\r\n    // detect available wheel event\r\n    support = \"onwheel\" in document.createElement(\"div\") ? \"wheel\" : // 各个厂商的高版本浏览器都支持\"wheel\"\r\n                document.onmousewheel !== undefined ? \"mousewheel\" : // Webkit 和 IE一定支持\"mousewheel\"\r\n                \"DOMMouseScroll\"; // 低版本firefox\r\n\r\n    window.addWheelListener = function( elem, callback, useCapture ) {\r\n        _addWheelListener( elem, support, callback, useCapture );\r\n\r\n        // handle MozMousePixelScroll in older Firefox\r\n        if( support == \"DOMMouseScroll\" ) {\r\n            _addWheelListener( elem, \"MozMousePixelScroll\", callback, useCapture );\r\n        }\r\n    };\r\n\r\n    function _addWheelListener( elem, eventName, callback, useCapture ) {\r\n        elem[ _addEventListener ]( prefix + eventName, support == \"wheel\" ? callback : function( originalEvent ) {\r\n            !originalEvent && ( originalEvent = window.event );\r\n\r\n            // create a normalized event object\r\n            var event = {\r\n                // keep a ref to the original event object\r\n                originalEvent: originalEvent,\r\n                target: originalEvent.target || originalEvent.srcElement,\r\n                type: \"wheel\",\r\n                deltaMode: originalEvent.type == \"MozMousePixelScroll\" ? 0 : 1,\r\n                deltaX: 0,\r\n                deltaZ: 0,\r\n                preventDefault: function() {\r\n                    originalEvent.preventDefault ?\r\n                        originalEvent.preventDefault() :\r\n                        originalEvent.returnValue = false;\r\n                }\r\n            };\r\n            \r\n            // calculate deltaY (and deltaX) according to the event\r\n            if ( support == \"mousewheel\" ) {\r\n                event.deltaY = - 1/40 * originalEvent.wheelDelta;\r\n                // Webkit also support wheelDeltaX\r\n                originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );\r\n            } else {\r\n                event.deltaY = originalEvent.detail;\r\n            }\r\n\r\n            // it's time to fire the callback\r\n            return callback( event );\r\n\r\n        }, useCapture || false );\r\n    }\r\n\r\n})(window,document);\r\n\r\nvar root = document.getElementById(\"main\");\r\n\r\nvar c = document.getElementById(\"canvas\");\r\nvar ctx = c.getContext('2d');\r\n\r\nvar magnifier = document.getElementById(\"magnifier\");\r\nvar magCtx = magnifier.getContext('2d');\r\n\r\nvar preContent = document.getElementById(\"pre-content\");\r\n\r\nvar functionContent = document.getElementById(\"function-content\");\r\nvar imageUploader = document.getElementById(\"image-uploader\");\r\nvar dragBox = document.getElementById(\"image-uploader-wrapper\");\r\nvar letterUploadBtn = document.getElementById(\"letter-upload-btn\");\r\n\r\nvar closeBtn = document.getElementById(\"close-btn\");\r\nvar sideUploadBtn = document.getElementById(\"side-upload-btn\");\r\nvar sideResetBtn = document.getElementById(\"side-reset-btn\");\r\n\r\nvar colorPicker = document.getElementById(\"color-picker\");\r\n\r\nvar rgbInput = document.getElementById(\"rgb-input\");\r\nvar rgbaInput = document.getElementById(\"rgba-input\");\r\nvar hexInput = document.getElementById(\"hex-input\");\r\n\r\nvar copyRbgBtn = document.getElementById(\"copy-rgb-btn\");\r\nvar copyRbgaBtn = document.getElementById(\"copy-rgba-btn\");\r\nvar copyHexBtn = document.getElementById(\"copy-hex-btn\");\r\n\r\n// drag\r\nvar hitPoint = {x: 0, y:0};\r\nvar moveStartOffset = {x: 0, y: 0};\r\n\r\n// load image\r\nvar image = new Image();\r\n\r\nvar elargeScale = 100;\r\nvar canvasHeight = c.height;\r\nvar canvasWidth  = c.width;\r\nvar desX = 0;\r\nvar desY = 0;\r\nvar imageHeight = 0;\r\nvar imageWidth = 0;\r\nvar desH = canvasHeight;\r\nvar desW = canvasWidth;\r\nvar aspectRatio = 1;\r\n\r\nvar initialParam = {};\r\n\r\nvar moveMode = 'left';\r\n\r\nfunction main() {\r\n    msieversion();\r\n    initEvent();\r\n}\r\n\r\nmain();\r\n    \r\n\r\nfunction initEvent() {\r\n    document.addEventListener(\"drop\",function(e){\r\n        e.preventDefault();      \r\n    })  \r\n    document.addEventListener(\"dragleave\",function(e){  \r\n        e.preventDefault();      \r\n    })  \r\n    document.addEventListener(\"dragenter\",function(e){ \r\n        e.preventDefault();      \r\n    })  \r\n    document.addEventListener(\"dragover\",function(e){ \r\n        e.preventDefault();      \r\n    });\r\n\r\n    functionContent.oncontextmenu = function (e) { return false; }\r\n\r\n    closeBtn.addEventListener('click', function() {\r\n        imageUploader.value=\"\";\r\n        show(preContent);\r\n        hide(functionContent);\r\n    });\r\n\r\n    sideUploadBtn.addEventListener('click', function() {\r\n        imageUploader.click();\r\n    });\r\n\r\n    sideResetBtn.addEventListener('click', function() {\r\n        reset();\r\n        imageWidth = initialParam.imgW;\r\n        imageHeight = initialParam.imgH;\r\n        desX = initialParam.dx;\r\n        desY = initialParam.dy;\r\n        desW = initialParam.dw;\r\n        desH = initialParam.dh;\r\n        aspectRatio = initialParam.aspectRatio;\r\n        draw(imageWidth, imageHeight, desX, desY, desW, desH);\r\n    });\r\n\r\n    letterUploadBtn.addEventListener('click', function() {\r\n        imageUploader.click();\r\n    });\r\n\r\n    imageUploader.addEventListener('change', function(e) {\r\n        var fileList = imageUploader.files;\r\n        if(fileList.length == 0){                \r\n            return false;            \r\n        }\r\n\r\n        loadImage(fileList, ctx);\r\n    })\r\n\r\n    dragBox.addEventListener(\"drop\",function(e){           \r\n        var fileList = e.dataTransfer.files;          \r\n        if(fileList.length == 0){                \r\n            return false;            \r\n        }\r\n\r\n        loadImage(fileList, ctx);\r\n    });\r\n\r\n    image.onload = function () {\r\n        reset();\r\n        imageHeight = image.height;\r\n        imageWidth = image.width;\r\n        aspectRatio = imageWidth/imageHeight;\r\n        if (imageHeight < canvasHeight && imageWidth < canvasWidth) {\r\n            desH = imageHeight;\r\n            desW = imageWidth;\r\n            desX = (canvasWidth - imageWidth)/2;\r\n            desY = (canvasHeight -imageHeight)/2;\r\n        } else {\r\n            if (imageWidth > imageHeight) {\r\n                desH = imageHeight * (canvasWidth/imageWidth);\r\n                desY = (canvasHeight - desH)/2;\r\n            } else {\r\n                desW = imageWidth * canvasHeight/imageHeight;\r\n                desX = (canvasWidth - desW)/2;\r\n            }\r\n        }\r\n        draw(imageWidth, imageHeight, desX, desY, desW, desH);\r\n        initialParam = {\r\n            imgW: imageWidth,\r\n            imgH: imageHeight,\r\n            dx: desX,\r\n            dy: desY,\r\n            dw: desW,\r\n            dh: desH,\r\n            aspectRatio: aspectRatio\r\n        }\r\n    }\r\n\r\n    c.onmousemove =  mousemove;\r\n    c.onmouseout = mouseout;\r\n\r\n    c.onmousedown = function(e) {\r\n        if (e.button ==2) return;\r\n        \r\n        moveMode = \"right\";\r\n        hitPoint = {\r\n            x: getRelativePosition(e.clientX, e.clientY).x,\r\n            y: getRelativePosition(e.clientX, e.clientY).y\r\n        };\r\n\r\n        moveStartOffset = {\r\n            x: desX,\r\n            y: desY\r\n        }\r\n\r\n        var color = getPixelColor(magCtx, 55, 55);\r\n        rgbInput.value = color.rgb;\r\n        rgbaInput.value = color.rgba;\r\n        hexInput.value = color.hex;\r\n    }\r\n\r\n    c.onmouseup = function(e) {\r\n        if (e.button ==2) return;\r\n\r\n        magnifier.style.display = \"inline\";\r\n        c.style.cursor = \"crosshair\";\r\n        moveMode = \"left\";\r\n        hitPoint = {x: 0, y: 0};\r\n        moveStartOffset = {x: 0, y: 0};\r\n    }\r\n\r\n    // c.addEventListener('click', function() {\r\n    \r\n    // });\r\n\r\n    copyRbgBtn.addEventListener('click', function() {\r\n        if (rgbInput.value) {\r\n            rgbInput.select();\r\n            document.execCommand('copy');\r\n        }\r\n    });\r\n\r\n    copyRbgaBtn.addEventListener('click', function() {\r\n        if (rgbInput.value) {\r\n            rgbaInput.select();\r\n            document.execCommand('copy');\r\n        }\r\n    });\r\n\r\n    copyHexBtn.addEventListener('click', function() {\r\n        if (rgbInput.value) {\r\n            hexInput.select();\r\n            document.execCommand('copy');\r\n        }\r\n    });\r\n\r\n    //mouse wheel\r\n    window.addWheelListener(c, function(e) {\r\n        e.preventDefault();\r\n\r\n        if ( e.deltaY < 0) {\r\n            elargeImage();\r\n        } else if(e.deltaY > 0) {\r\n            shrinkImage();\r\n        }\r\n        \r\n    });    \r\n}\r\n\r\nfunction mousemove(e) {\r\n    // relative to canvas' bound\r\n    var relativePos = getRelativePosition(e.clientX, e.clientY);\r\n    magnifier.style.left = e.clientX + 45 + 'px';\r\n    magnifier.style.top = e.clientY + 15 + 'px';\r\n    \r\n    if (moveMode == 'left') {   \r\n        magnify(relativePos);\r\n    }\r\n\r\n    if (moveMode == 'right') {\r\n        c.style.cursor = \"move\";\r\n        magnifier.style.display = \"none\";\r\n        dragImage(relativePos);\r\n    }\r\n}\r\n\r\nfunction mouseout(e) {\r\n    magnifier.style.display = 'none';\r\n    c.style.cursor = \"crosshair\";\r\n    moveMode = \"left\";\r\n    hitPoint = {x: 0, y: 0};\r\n    moveStartOffset = {x: 0, y: 0};\r\n}\r\n\r\nfunction dragImage(relativePos) {\r\n    desX = moveStartOffset.x + (relativePos.x - hitPoint.x);\r\n    desY = moveStartOffset.y + (relativePos.y - hitPoint.y);\r\n    draw(imageWidth, imageHeight, desX, desY, desW, desH);\r\n}\r\n\r\nfunction elargeImage() {\r\n    if (desH > imageHeight || desH == imageHeight || desW > imageWidth || desW == imageWidth) return;\r\n    desY -= elargeScale/2\r\n    desX -= elargeScale * aspectRatio/2\r\n    desH += elargeScale\r\n    desW += elargeScale * aspectRatio\r\n    draw(imageWidth, imageHeight, desX, desY, desW, desH);\r\n}\r\n\r\nfunction shrinkImage() {\r\n    if (desH < 0 || desH == 0 || desW < 0 || desW == 0) return;\r\n    desY += elargeScale/2\r\n    desX += elargeScale * aspectRatio/2\r\n    desH -= elargeScale\r\n    desW -= elargeScale * aspectRatio\r\n    draw(imageWidth, imageHeight, desX, desY, desW, desH);\r\n}\r\n\r\nfunction magnify(relativePos) {\r\n    magnifier.style.display = 'inline';\r\n    magCtx.clearRect(0, 0, magnifier.width, magnifier.height);\r\n\r\n    var rect = [];\r\n    var ix = relativePos.x -5.5;\r\n    for (var i = 0; i < 11; i++) {\r\n        var iy = relativePos.y - 5.5;\r\n        rect[i] = [];\r\n        for (var j = 0; j < 11; j++) { \r\n            rect[i][j] = getPixelColor(ctx, ix, iy).rgba;\r\n            magCtx.fillStyle =  rect[i][j];\r\n            magCtx.fillRect(i*10, j*10, 10, 10);            \r\n            iy++;\r\n        }\r\n        ix++;\r\n    }\r\n\r\n    for (var x = 0; x < 11; x++) {\r\n        if (x == 0) continue;\r\n        magCtx.beginPath();\r\n        magCtx.strokeStyle = '#666';\r\n        magCtx.moveTo(0.5, x*10 + .5);\r\n        magCtx.lineTo(110.5, x*10 + .5);\r\n        magCtx.stroke();\r\n        magCtx.closePath();\r\n\r\n        magCtx.beginPath();\r\n        magCtx.strokeStyle = '#666';\r\n        magCtx.moveTo(x*10 + .5, 0.5);\r\n        magCtx.lineTo(x*10 + .5, 110.5);\r\n        magCtx.stroke();\r\n        magCtx.closePath();\r\n    }\r\n\r\n    magCtx.beginPath();\r\n    magCtx.strokeStyle = 'red';\r\n    magCtx.moveTo(50.5, 50.5);\r\n    magCtx.lineTo(60.5, 50.5);\r\n    magCtx.lineTo(60.5, 60.5);\r\n    magCtx.lineTo(50.5, 60.5);\r\n    magCtx.lineTo(50.5, 50.5);\r\n    magCtx.stroke();\r\n    magCtx.closePath();\r\n}\r\n\r\nfunction loadImage(fileList, ctx) {\r\n    var file = fileList[0];\r\n    if (file.type.indexOf('image') !==0) {\r\n        alert(\"该文件不是图片文件\");\r\n        return;\r\n    }\r\n    var fileurl = window.URL.createObjectURL(file);\r\n\r\n    image.src = fileurl;\r\n}\r\n\r\nfunction draw(imgW, imgH, oL, oT, ideW, idwH) {\r\n    ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n    \r\n    ctx.drawImage(image, 0, 0, imgW, imgH, oL, oT, ideW, idwH);\r\n    show(functionContent);\r\n    hide(preContent);\r\n}\r\n\r\nfunction reset() {\r\n    canvasHeight = c.height;\r\n    canvasWidth  = c.width;\r\n    desX = 0;\r\n    desY = 0;\r\n    imageHeight = 0;\r\n    imageWidth = 0;\r\n    desH = canvasHeight;\r\n    desW = canvasWidth;\r\n    aspectRatio = 1;\r\n    hitPoint = {x: 0, y: 0};\r\n    moveStartOffset = {x: 0, y: 0};\r\n}\r\n\r\nfunction getPixelColor(targetCtx, x, y){\r\n\tvar imageData = targetCtx.getImageData(x, y, 1, 1);\r\n\tvar pixel = imageData.data;\r\n\tvar r = pixel[0];\r\n\tvar g = pixel[1];\r\n\tvar b = pixel[2];\r\n\tvar a = pixel[3] / 255\r\n\ta = Math.round(a * 100) / 100;\r\n\tvar rHex = r.toString(16);\r\n\tr < 16 && (rHex = \"0\" + rHex);\r\n\tvar gHex = g.toString(16);\r\n\tg < 16 && (gHex = \"0\" + gHex);\r\n\tvar bHex = b.toString(16);\r\n\tb < 16 && (bHex = \"0\" + bHex);\r\n\tvar rgbaColor = \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + a + \")\";\r\n\tvar rgbColor = \"rgb(\" + r + \",\" + g + \",\" + b + \")\";\r\n\tvar hexColor = \"#\" + rHex + gHex + bHex;\r\n\treturn {\r\n\t\trgba : rgbaColor,\r\n\t\trgb : rgbColor,\r\n\t\thex : hexColor,\r\n\t\tr : r,\r\n\t\tg : g,\r\n\t\tb : b,\r\n\t\ta : a\r\n\t};\r\n}\r\n\r\nfunction hide(elem) {\r\n    elem.style.display = 'none';\r\n}\r\n\r\nfunction show(elem) {\r\n    elem.style.display = 'block';\r\n}\r\n\r\nfunction getRelativePosition(mouseX, mouseY, ele) {\r\n    var pos = c.getBoundingClientRect();\r\n    return {\r\n        x: mouseX - pos.x,\r\n        y: mouseY - pos.y\r\n    };\r\n};"]}